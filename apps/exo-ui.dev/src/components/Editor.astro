---
import fs from 'node:fs/promises';

import { Editor } from "./Editor.tsx";

const prefix = import.meta.env.MODE === 'development' ? '..' : '../../src';

const urls = Astro.props.files.map(item => new URL(`${prefix}/examples/${item.file}`, import.meta.url));
const requests = urls.map(url => fs.readFile(url, 'utf-8'));
const contents  = await Promise.all(requests);

const formatted = Astro.props.files.map((item, index) => ([item.name, contents[index]]));
const files = Object.fromEntries(new Map(formatted));

const [{ name: active }] = Astro.props.files;
---
<div class="not-content">
  <Editor client:load files={files} active={active} />
</div>
